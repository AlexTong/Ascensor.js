/*
Ascensor.js 
version: 1.6.2 (2013-10-12)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: LÃ©o Galley <contact@kirkas.ch>
*/
(function(o,n,t){function i(n,t){this.element=n,this.options=o.extend({},e,t),this._defaults=e,this._name=s,this.init()}var s="ascensor",e={ascensorName:"ascensor",ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",loop:!0,ascensorMap:"",time:"1000",easing:"linear",keyNavigation:!0,touchSwipeIntegration:!1,queued:!1,queuedDirection:"x"};i.prototype.init=function(){function i(){f=k.width(),h=k.height(),w.width(f).height(h),m.width(f).height(h),"y"===g.options.direction&&m.stop().scrollTop(g.floorActive*h),"x"===g.options.direction&&(m.stop().scrollLeft(g.floorActive*f),w.each(function(n){o(this).css("left",n*f)})),"chocolate"===g.options.direction&&(w.each(function(n){o(this).css({left:g.options.ascensorMap[n][1]*f,top:g.options.ascensorMap[n][0]*h})}),m.stop().scrollLeft(g.options.ascensorMap[v][1]*f).scrollTop(g.options.ascensorMap[v][0]*h))}function s(o){if("y"==g.options.direction){if("left"==o)return;"down"==o?c():"up"==o&&e()}else if("y"==g.options.direction){if("up"==o)return;"left"==o?e():"right"==o&&c()}else"chocolate"==g.options.direction&&("down"==o?a(1,0):"up"==o?a(-1,0):"left"==o?a(0,-1):"right"==o&&a(0,1))}function e(){var o=v-1;0>o&&(o=g.options.loop?y:0),r(o,g.options.time)}function c(){var o=v+1;o>y&&(o=g.options.loop?0:y),r(o,g.options.time)}function a(n,t){var i=[g.options.ascensorMap[v][0]+n,g.options.ascensorMap[v][1]+t];o.each(g.options.ascensorMap,function(o){""+i==""+g.options.ascensorMap[o]&&r(o,g.options.time)})}function p(t){n.location.hash&&(d=n.location.hash.split("/").pop(),o(g.options.ascensorFloorName).each(function(n){d===g.options.ascensorFloorName[n]&&(v=n,o("."+g.options.ascensorName+"Link").removeClass(g.options.ascensorName+"LinkActive").eq(v).addClass(g.options.ascensorName+"LinkActive"),t||r(v,g.options.time,!0))}))}function r(t,i,s){var e={time:i,easing:g.options.easing,callback:function(){l()}};if("y"===g.options.direction)e.property={scrollTop:t*h};else if("x"===g.options.direction)e.property={scrollLeft:t*f};else if("chocolate"===g.options.direction&&(e.property={scrollLeft:g.options.ascensorMap[t][1]*f,scrollTop:g.options.ascensorMap[t][0]*h},g.options.queued)){var c=m.scrollLeft()===g.options.ascensorMap[t][1]*f,a=m.scrollTop()===g.options.ascensorMap[t][0]*h;"x"===g.options.queuedDirection?c?e.property={scrollTop:g.options.ascensorMap[t][0]*h}:(e.property={scrollLeft:g.options.ascensorMap[t][1]*f},e.callback=function(){m.stop().animate({scrollTop:g.options.ascensorMap[t][0]*h},i,g.options.easing,function(){l()})}):"y"===g.options.queuedDirection&&(a?e.property={scrollLeft:g.options.ascensorMap[t][1]*f}:(e.property={scrollTop:g.options.ascensorMap[t][0]*h},e.callback=function(){m.stop().animate({scrollLeft:g.options.ascensorMap[t][1]*f},i,g.options.easing,function(){l()})}))}m.stop().animate(e.property,i,g.options.easing,e.callback),s||null===g.options.ascensorFloorName||(n.location.hash="/"+g.options.ascensorFloorName[t]),o("."+g.options.ascensorName+"Link").removeClass(g.options.ascensorName+"LinkActive"),o("."+g.options.ascensorName+"Link"+t).addClass(g.options.ascensorName+"LinkActive"),v=t}function l(){m.trigger({type:"ascensorEnd",floor:v})}function u(n){if(!o("input, textarea, button").is(":focus"))switch(n.which){case 40:case 83:s("down");break;case 38:case 87:s("up");break;case 37:case 65:s("left");break;case 39:case 68:s("right")}}var f,h,d,g=this,m=o(this.element),w=m.children(g.options.childType),v=g.options.windowsOn,y=-1,M=(g.options.direction,o(t)),k=o(n);m.on("scrollToStage",function(o,n){"next"==n?c():"prev"==n?e():s(n)}),m.on("scrollToFloor",function(o,n){n>y||r(n)}),m.on("next",function(){c()}),m.on("prev",function(){e()}),m.on("update",function(){w=m.children(g.options.childType),i()}),m.css({position:"absolute",width:f,height:h}),w.width(f).height(h).each(function(){y+=1}),("x"===g.options.direction||"chocolate"===g.options.direction)&&w.css({position:"absolute",overflow:"auto"}),g.options.keyNavigation&&M.keydown(u),k.resize(function(){i()}).load(function(){i()}).resize(),n.DeviceOrientationEvent&&k.bind("orientationchange",function(){i()}),k.on("hashchange",function(){p()}),r(v,1,!0),p(!0),g.options.touchSwipeIntegration&&m.swipe({swipe:function(o,n){var t="";"up"==n?t="Down":"down"==n?t="Up":"left"==n?t="Right":"right"==n&&(t="Left"),m.trigger({type:"ascensor"+t,floor:v})},threshold:70})},o.fn[s]=function(n){return this.each(function(){o.data(this,"plugin_"+s)||o.data(this,"plugin_"+s,new i(this,n))})}})(jQuery,window,document);