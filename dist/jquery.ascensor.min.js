/*
Ascensor.js 
version: 1.7.0 (2013-12-15)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: LÃ©o Galley <contact@kirkas.ch>
*/
(function(o,t,i){function n(t,i){this.element=t,this.options=o.extend({},r,i),this._defaults=r,this._name=e,this.init()}var e="ascensor",r={ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",loop:!1,time:300,easing:"linear",keyNavigation:!0,touchSwipeIntegration:!1,queued:!1,jump:!1};n.prototype.init=function(){function n(){u=x.width(),f=x.height(),m.width(u).height(f),g.width(u).height(f),"y"===d.options.direction&&g.stop().scrollTop(v*f),"x"===d.options.direction&&(g.stop().scrollLeft(v*u),m.each(function(t){o(this).css("left",t*u)})),b&&(m.each(function(t){o(this).css({left:d.options.direction[t][1]*u,top:d.options.direction[t][0]*f})}),c(v,1),g.stop().scrollLeft(d.options.direction[v][1]*u).scrollTop(d.options.direction[v][0]*f))}function e(){function t(t,i,n,e){var r=t[n],s=!1;return o.each(i,function(){(("right"==e||"down"==e)&&this[n]>t[n]||("left"==e||"up"==e)&&this[n]<t[n])&&(!s||Math.abs(this[n]-r)<Math.abs(s[n]-r))&&(s=this)}),s&&-1!==d.options.direction.indexOf(s)?d.options.direction.indexOf(s):!1}function i(t,i,n){var e=t[n],r=!1;return o.each(i,function(){(!r||Math.abs(this[n]-e)>Math.abs(r[n]-e))&&(r=this)}),r&&-1!==d.options.direction.indexOf(r)?d.options.direction.indexOf(r):!1}function n(t,i){var n=0,e=!1;return o.each(t,function(){(!e||Math.abs(this[i]-n)>Math.abs(e[i]-n))&&(e=this)}),e&&-1!==d.options.direction.indexOf(e)?d.options.direction.indexOf(e):!1}function e(t,i){var n=0,e=!1;return o.each(t,function(){(!e||Math.abs(this[i]-n)>Math.abs(e[i]-n))&&(e=this)}),e&&-1!==d.options.direction.indexOf(e)?d.options.direction.indexOf(e):!1}function r(o,t,i,n){return i[0]+o==n[0]&&i[1]+t==n[1]?d.options.direction.indexOf(n):!1}o.each(d.options.direction,function(s,c){var p=jQuery.grep(d.options.direction,function(o){var t=o[0]==c[0],i=c==o;return t&&!i}),a=jQuery.grep(d.options.direction,function(o){var t=o[1]==c[1],i=c==o;return t&&!i}),l=jQuery.grep(d.options.direction,function(o){var t=o[0]==c[0]+1;return t}),u=jQuery.grep(d.options.direction,function(o){var t=o[0]==c[0]-1;return t}),f=jQuery.grep(d.options.direction,function(o){var t=o[1]==c[1]+1;return t}),h=jQuery.grep(d.options.direction,function(o){var t=o[1]==c[1]-1;return t});T[s]={down:!1,up:!1,right:!1,left:!1,increment:{down:n(f,1),up:e(h,0),right:n(l,0),left:e(u,1)},closest:{down:t(c,a,0,"down"),up:t(c,a,0,"up"),right:t(c,p,1,"right"),left:t(c,p,1,"left")},furthest:{down:i(c,a,0,"down"),up:i(c,a,0,"up"),right:i(c,p,1,"right"),left:i(c,p,1,"left")}},o.each(d.options.direction,function(o,t){T[s].down===!1&&(T[s].down=r(1,0,c,t)),T[s].up===!1&&(T[s].up=r(-1,0,c,t)),T[s].right===!1&&(T[s].right=r(0,1,c,t)),T[s].left===!1&&(T[s].left=r(0,-1,c,t))})})}function r(o){if("y"==d.options.direction){if("left"==o)return;"down"==o?d.next():"up"==o&&d.prev()}else if("x"==d.options.direction){if("up"==o)return;"left"==o?d.prev():"right"==o&&d.next()}else if(b){var t;T[v][o]!==!1?t=T[v][o]:d.options.jump===!0&&T[v].closest[o]!==!1?t=T[v].closest[o]:d.options.loop===!0&&T[v].furthest[o]!==!1?t=T[v].furthest[o]:"increment"===d.options.loop&&T[v].increment[o]!==!1?t=T[v].increment[o]:"increment-x"!==d.options.loop||"right"!=o&&"left"!=o||T[v].increment[o]===!1?"increment-y"!==d.options.loop||"down"!=o&&"up"!=o||T[v].increment[o]===!1?"loop-x"!=d.options.loop||"right"!=o&&"left"!=o||T[v].furthest[o]===!1?"loop-y"!=d.options.loop||"down"!=o&&"up"!=o||T[v].furthest[o]===!1||(t=T[v].furthest[o]):t=T[v].furthest[o]:t=T[v].increment[o]:t=T[v].increment[o],"number"==typeof t&&c(t,d.options.time)}}function s(){if(t.location.hash){h=t.location.hash.split("/").pop();var i=!1;return o.each(d.options.ascensorFloorName,function(o){h===d.options.ascensorFloorName[o]&&(i=o)}),i}}function c(o,i){p(v,o);var n={time:i||d.options.time,easing:d.options.easing,callback:function(){a(v,o)}};if("y"===d.options.direction)n.property={scrollTop:o*f};else if("x"===d.options.direction)n.property={scrollLeft:o*u};else if(b&&(n.property={scrollLeft:d.options.direction[o][1]*u,scrollTop:d.options.direction[o][0]*f},d.options.queued)){var e=g.scrollLeft()===d.options.direction[o][1]*u,r=g.scrollTop()===d.options.direction[o][0]*f;"x"===d.options.queued?e?n.property={scrollTop:d.options.direction[o][0]*f}:(n.property={scrollLeft:d.options.direction[o][1]*u},n.callback=function(){g.stop().animate({scrollTop:d.options.direction[o][0]*f},i,d.options.easing,function(){a(v,o)})}):"y"===d.options.queued&&(r?n.property={scrollLeft:d.options.direction[o][1]*u}:(n.property={scrollTop:d.options.direction[o][0]*f},n.callback=function(){g.stop().animate({scrollLeft:d.options.direction[o][1]*u},i,d.options.easing,function(){a(v,o)})}))}g.stop().animate(n.property,i,d.options.easing,n.callback),d.options.ascensorFloorName&&(t.location.hash="/"+d.options.ascensorFloorName[o]),v=o,g.data("current-floor",v)}function p(o,t){var i={from:o,to:t};g.trigger("scrollStart",i)}function a(o,t){var i={from:o,to:t};g.trigger("scrollEnd",i)}function l(t){var i=t.which;if(!o("input, textarea, button").is(":focus"))switch(i){case 40:case 83:if("x"==d.options.direction)return;g.trigger("scrollToDirection","down");break;case 38:case 87:if("x"==d.options.direction)return;g.trigger("scrollToDirection","up");break;case 37:case 65:if("y"==d.options.direction)return;g.trigger("scrollToDirection","left");break;case 39:case 68:if("y"==d.options.direction)return;g.trigger("scrollToDirection","right")}}var u,f,h,d=this,g=o(this.element),m=g.children(d.options.childType),v=d.options.windowsOn,y=-1,w=(d.options.direction,o(i)),x=o(t),b="object"==typeof d.options.direction,T=[];if(this.prev=function(){var o=v-1;if(0>o){if(!d.options.loop)return;o=y}c(o,d.options.time)},this.next=function(){var o=v+1;if(o>y){if(!d.options.loop)return;o=0}c(o,d.options.time)},g.on("scrollToDirection",function(o,t){r(t)}),g.on("scrollToStage",function(t,i){if("string"==typeof i){var n=o.inArray(i,d.options.ascensorFloorName);-1!==n&&c(n,d.options.time)}else if("number"==typeof i){if(i>y)return;c(i,d.options.time)}}),g.on("next",function(){d.next()}),g.on("prev",function(){d.prev()}),g.on("refresh",function(){(g.children().length>m.length||g.children().length<m.length)&&(m=g.children(d.options.childType),("x"===d.options.direction||b)&&m.css({position:"absolute",overflow:"auto"}),y=-1,m.each(function(){y+=1}),childrenLenght=g.children().length,g.trigger("refresh"),n())}),g.css({position:"absolute",overflow:"hidden"}),m.each(function(){y+=1}),("x"===d.options.direction||b)&&m.css({position:"absolute",overflow:"auto"}),b&&e(),g.data("current-floor",v),d.options.keyNavigation&&w.keydown(l),d.options.ascensorFloorName&&t.location.hash){var O=s();O&&(v=O)}c(v,1),d.options.touchSwipeIntegration&&g.swipe({swipe:function(o,t){g.trigger("scrollToDirection",t)},threshold:70}),o(t).on("hashchange",function(){var o=s();o&&!g.is(":animated")&&c(o,d.options.time)}),x.resize(function(){n()}).load(function(){n()}).resize(),t.DeviceOrientationEvent&&x.bind("orientationchange",function(){n()})},o.fn[e]=function(t){return this.each(function(){o.data(this,"plugin_"+e)||o.data(this,"plugin_"+e,new n(this,t))})}})(jQuery,window,document);