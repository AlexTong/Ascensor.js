/*
Ascensor.js 
version: 1.8.0 (2014-02-16)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: LÃ©o Galley <contact@kirkas.ch>
*/
!function(a,b,c,d){function e(b,c){this.element=b,this.options=a.extend({},g,c),this._defaults=g,this._name=f,this.init()}var f="ascensor",g={ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",loop:!1,width:"100%",height:"100%",time:300,easing:"linear",keyNavigation:!0,touchSwipeIntegration:!1,queued:!1,jump:!1,ready:!1};e.prototype.init=function(){function e(){var a,e=c.createElement("p"),f={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};c.body.insertBefore(e,null);for(var g in f)e.style[g]!==d&&(e.style[g]="translate3d(1px,1px,1px)",a=b.getComputedStyle(e).getPropertyValue(f[g]));return c.body.removeChild(e),a!==d&&a.length>0&&"none"!==a}function f(a,b){var c=p;"top"==b&&(c=o);var d={property:a*c};if(r.supportTransform){var e="translateX";"top"==b&&(e="translateY"),d={transform:e+"("+100*a+"%)"}}return d}function g(){p=s.width(),o=s.height(),"y"===r.options.direction&&(s.stop().scrollTop(u*o),t.each(function(b){a(this).css(f(b,"top"))})),"x"===r.options.direction&&(s.stop().scrollLeft(u*p),t.each(function(b){a(this).css(f(b,"left"))})),y&&(s.stop().scrollLeft(r.options.direction[u][1]*p).scrollTop(r.options.direction[u][0]*o),t.each(function(b){var c={left:r.options.direction[b][1]*p,top:r.options.direction[b][0]*o};r.supportTransform&&(c={transform:"translateX("+100*r.options.direction[b][1]+"%) translateY("+100*r.options.direction[b][0]+"%)"}),a(this).css(c)}))}function h(){function b(b,c,d,e){var f=b[d],g=!1;return a.each(c,function(){(("right"==e||"down"==e)&&this[d]>b[d]||("left"==e||"up"==e)&&this[d]<b[d])&&(!g||Math.abs(this[d]-f)<Math.abs(g[d]-f))&&(g=this)}),g&&-1!==j.indexOf(g)?j.indexOf(g):!1}function c(b,c,d){var e=b[d],f=!1;return a.each(c,function(){(!f||Math.abs(this[d]-e)>Math.abs(f[d]-e))&&(f=this)}),f&&-1!==j.indexOf(f)?j.indexOf(f):!1}function d(b,c){var d=0,e=!1;return a.each(b,function(){(!e||Math.abs(this[c]-d)>Math.abs(e[c]-d))&&(e=this)}),e&&-1!==j.indexOf(e)?j.indexOf(e):!1}function e(b,c){var d=0,e=!1;return a.each(b,function(){(!e||Math.abs(this[c]-d)>Math.abs(e[c]-d))&&(e=this)}),e&&-1!==j.indexOf(e)?j.indexOf(e):!1}function f(a,b,c,d){return c[0]+a==d[0]&&c[1]+b==d[1]?j.indexOf(d):!1}function g(a,b){var c=!1;return jQuery.each(a,function(a,d){(c===!1||c[b]<d[b])&&(c=d)}),c}function h(a,b){var c=!1;return jQuery.each(a,function(a,d){(c===!1||c[b]>d[b])&&(c=d)}),c}function i(a,b){return jQuery.grep(j,function(c){var d=c[b]==a[b];return d})}var j=jQuery.grep(r.options.direction,function(a,b){return s.children().length>b}),k=g(j,1),l=i(k,1),m=g(l,0),n=g(j,0),o=i(n,0),p=g(o,1);z.furthest_x=j.indexOf(p),z.furthest_y=j.indexOf(m);var q=h(j,1),t=i(q,1),u=h(t,0),v=h(j,0),w=i(v,0),x=h(w,1);z.closest_x=j.indexOf(x),z.closest_y=j.indexOf(u),a.each(j,function(g,h){var i=jQuery.grep(j,function(a){var b=a[0]==h[0],c=h==a;return b&&!c}),k=jQuery.grep(j,function(a){var b=a[1]==h[1],c=h==a;return b&&!c}),l=jQuery.grep(j,function(a){var b=a[0]==h[0]+1;return b}),m=jQuery.grep(j,function(a){var b=a[0]==h[0]-1;return b}),n=jQuery.grep(j,function(a){var b=a[1]==h[1]+1;return b}),o=jQuery.grep(j,function(a){var b=a[1]==h[1]-1;return b});z[g]={down:!1,up:!1,right:!1,left:!1,increment:{down:d(n,1),up:e(o,0),right:d(l,0),left:e(m,1)},closest:{down:b(h,k,0,"down"),up:b(h,k,0,"up"),right:b(h,i,1,"right"),left:b(h,i,1,"left")},furthest:{down:c(h,k,0,"down"),up:c(h,k,0,"up"),right:c(h,i,1,"right"),left:c(h,i,1,"left")}},a.each(j,function(a,b){z[g].down===!1&&(z[g].down=f(1,0,h,b)),z[g].up===!1&&(z[g].up=f(-1,0,h,b)),z[g].right===!1&&(z[g].right=f(0,1,h,b)),z[g].left===!1&&(z[g].left=f(0,-1,h,b))})})}function i(a){if("y"==r.options.direction){if("left"==a)return;"down"==a?r.next():"up"==a&&r.prev()}else if("x"==r.options.direction){if("up"==a)return;"left"==a?r.prev():"right"==a&&r.next()}else if(y){var b;if(z[u][a]!==!1)b=z[u][a];else if(r.options.jump===!0&&z[u].closest[a]!==!1)b=z[u].closest[a];else if(r.options.loop===!0)b=z[u].furthest[a];else if("loop-x"!=r.options.loop||"right"!=a&&"left"!=a||z[u].furthest[a]===!1)if("loop-y"!=r.options.loop||"down"!=a&&"up"!=a||z[u].furthest[a]===!1){if("string"==typeof r.options.loop){var c=("down"==a||"up"==a)&&"increment-y"==r.options.loop,d=("right"==a||"left"==a)&&"increment-x"==r.options.loop;if(z[u].increment[a]!==!1)(c||d||"increment"==r.options.loop)&&(b=z[u].increment[a]);else if("right"==a||"left"==a){if("increment-y"==r.options.loop)return;u==z.furthest_x?b=z.closest_x:u==z.closest_x&&(b=z.furthest_x)}else if("down"==a||"up"==a){if("increment-x"==r.options.loop)return;u==z.furthest_y?b=z.closest_y:u==z.closest_y&&(b=z.furthest_y)}}}else b=z[u].furthest[a];else b=z[u].furthest[a];"number"==typeof b&&k(b,r.options.time)}}function j(){if(b.location.hash){q=b.location.hash.split("#").pop();var c=!1;return a.each(r.options.ascensorFloorName,function(a){q===r.options.ascensorFloorName[a]&&(c=a)}),c}}function k(a,c,d){d=d||!1,l(u,a);var e={time:c||r.options.time,easing:r.options.easing,callback:function(){m(u,a)}};if("y"===r.options.direction)e.property={scrollTop:a*o};else if("x"===r.options.direction)e.property={scrollLeft:a*p};else if(y&&(e.property={scrollLeft:r.options.direction[a][1]*p,scrollTop:r.options.direction[a][0]*o},r.options.queued)){var f=s.scrollLeft()===r.options.direction[a][1]*p,g=s.scrollTop()===r.options.direction[a][0]*o;"x"===r.options.queued?f?e.property={scrollTop:r.options.direction[a][0]*o}:(e.property={scrollLeft:r.options.direction[a][1]*p},e.callback=function(){s.stop().animate({scrollTop:r.options.direction[a][0]*o},c,r.options.easing,function(){m(u,a)})}):"y"===r.options.queued&&(g?e.property={scrollLeft:r.options.direction[a][1]*p}:(e.property={scrollTop:r.options.direction[a][0]*o},e.callback=function(){s.stop().animate({scrollLeft:r.options.direction[a][1]*p},c,r.options.easing,function(){m(u,a)})}))}s.stop().animate(e.property,c,r.options.easing,e.callback),d&&"function"==typeof r.options.ready&&r.options.ready(),r.options.ascensorFloorName&&b.location.replace((""+b.location).split("#")[0]+"#"+r.options.ascensorFloorName[a]),u=a,s.data("current-floor",u)}function l(a,b){var c={from:a,to:b};s.trigger("scrollStart",c)}function m(a,b){var c={from:a,to:b};s.trigger("scrollEnd",c)}function n(b){var c=b.which;if(!a("input, textarea, button").is(":focus"))switch(c){case 40:case 83:if("x"==r.options.direction)return;s.trigger("scrollToDirection","down");break;case 38:case 87:if("x"==r.options.direction)return;s.trigger("scrollToDirection","up");break;case 37:case 65:if("y"==r.options.direction)return;s.trigger("scrollToDirection","left");break;case 39:case 68:if("y"==r.options.direction)return;s.trigger("scrollToDirection","right")}}var o,p,q,r=this,s=a(this.element),t=s.children(r.options.childType),u=r.options.windowsOn,v=-1,w=(r.options.direction,a(c)),x=a(b),y="object"==typeof r.options.direction;Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length>>>0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),r.supportTransform=e();var z=[];if(this.prev=function(){var a=u-1;if(0>a){if(!r.options.loop)return;a=v}k(a,r.options.time)},this.next=function(){var a=u+1;if(a>v){if(!r.options.loop)return;a=0}k(a,r.options.time)},s.on("scrollToDirection",function(a,b){i(b)}),s.on("scrollToStage",function(b,c){if("string"==typeof c){var d=a.inArray(c,r.options.ascensorFloorName);-1!==d&&k(d,r.options.time)}else if("number"==typeof c){if(c>v)return;k(c,r.options.time)}}),s.on("next",function(){r.next()}),s.on("prev",function(){r.prev()}),s.on("refresh",function(){(s.children().length>t.length||s.children().length<t.length)&&(t=s.children(r.options.childType),("x"===r.options.direction||y)&&t.css({position:"absolute",overflow:"auto",top:"0",left:"0",width:"100%",height:"100%"}),v=-1,t.each(function(){v+=1}),childrenLenght=s.children().length,s.trigger("refresh"),g(),h())}),t.each(function(){v+=1}),s.css({position:"absolute",overflow:"hidden",top:"0",left:"0",width:r.options.width,height:r.options.height}),t.css({position:"absolute",overflow:"auto",top:"0",left:"0",width:"100%",height:"100%"}),o=s.width(),p=s.height(),y&&h(),s.data("current-floor",u),r.options.keyNavigation&&w.keydown(n),r.options.ascensorFloorName&&b.location.hash){var A=j();A&&(u=A)}r.options.touchSwipeIntegration&&s.swipe({swipe:function(a,b){s.trigger("scrollToDirection",b)},threshold:70}),a(b).on("hashchange",function(){var a=j();a&&!s.is(":animated")&&k(a,r.options.time)}),x.resize(function(){g()}).load(function(){g()}).resize(),b.DeviceOrientationEvent&&x.bind("orientationchange",function(){g()}),k(u,1,!0)},a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);