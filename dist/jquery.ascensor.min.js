/*
Ascensor.js 
version: 1.7.0 (2014-02-16)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: LÃ©o Galley <contact@kirkas.ch>
*/
!function(a,b,c){function d(b,c){this.element=b,this.options=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="ascensor",f={ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",loop:!1,width:"100%",height:"100%",context:a(b),time:300,easing:"linear",keyNavigation:!0,touchSwipeIntegration:!1,queued:!1,jump:!1,ready:!1};d.prototype.init=function(){function d(a,b){return"string"!=typeof a?a:-1!==a.indexOf("%")?b/100*parseInt(a,10):-1!==a.indexOf("px")?parseInt(a,10):void 0}function e(){m=d(p.options.width,p.options.context.width()),n=d(p.options.height,p.options.context.height()),r.width(m).height(n),q.width(m).height(n),"y"===p.options.direction&&q.stop().scrollTop(s*n),"x"===p.options.direction&&(q.stop().scrollLeft(s*m),r.each(function(b){a(this).css("left",b*m)})),w&&(r.each(function(b){a(this).css({left:p.options.direction[b][1]*m,top:p.options.direction[b][0]*n})}),q.stop().scrollLeft(p.options.direction[s][1]*m).scrollTop(p.options.direction[s][0]*n))}function f(){function b(b,c,d,e){var f=b[d],g=!1;return a.each(c,function(){(("right"==e||"down"==e)&&this[d]>b[d]||("left"==e||"up"==e)&&this[d]<b[d])&&(!g||Math.abs(this[d]-f)<Math.abs(g[d]-f))&&(g=this)}),g&&-1!==j.indexOf(g)?j.indexOf(g):!1}function c(b,c,d){var e=b[d],f=!1;return a.each(c,function(){(!f||Math.abs(this[d]-e)>Math.abs(f[d]-e))&&(f=this)}),f&&-1!==j.indexOf(f)?j.indexOf(f):!1}function d(b,c){var d=0,e=!1;return a.each(b,function(){(!e||Math.abs(this[c]-d)>Math.abs(e[c]-d))&&(e=this)}),e&&-1!==j.indexOf(e)?j.indexOf(e):!1}function e(b,c){var d=0,e=!1;return a.each(b,function(){(!e||Math.abs(this[c]-d)>Math.abs(e[c]-d))&&(e=this)}),e&&-1!==j.indexOf(e)?j.indexOf(e):!1}function f(a,b,c,d){return c[0]+a==d[0]&&c[1]+b==d[1]?j.indexOf(d):!1}function g(a,b){var c=!1;return jQuery.each(a,function(a,d){(c===!1||c[b]<d[b])&&(c=d)}),c}function h(a,b){var c=!1;return jQuery.each(a,function(a,d){(c===!1||c[b]>d[b])&&(c=d)}),c}function i(a,b){return jQuery.grep(j,function(c){var d=c[b]==a[b];return d})}var j=jQuery.grep(p.options.direction,function(a,b){return q.children().length>b}),k=g(j,1),l=i(k,1),m=g(l,0),n=g(j,0),o=i(n,0),r=g(o,1);x.furthest_x=j.indexOf(r),x.furthest_y=j.indexOf(m);var s=h(j,1),t=i(s,1),u=h(t,0),v=h(j,0),w=i(v,0),y=h(w,1);x.closest_x=j.indexOf(y),x.closest_y=j.indexOf(u),a.each(j,function(g,h){var i=jQuery.grep(j,function(a){var b=a[0]==h[0],c=h==a;return b&&!c}),k=jQuery.grep(j,function(a){var b=a[1]==h[1],c=h==a;return b&&!c}),l=jQuery.grep(j,function(a){var b=a[0]==h[0]+1;return b}),m=jQuery.grep(j,function(a){var b=a[0]==h[0]-1;return b}),n=jQuery.grep(j,function(a){var b=a[1]==h[1]+1;return b}),o=jQuery.grep(j,function(a){var b=a[1]==h[1]-1;return b});x[g]={down:!1,up:!1,right:!1,left:!1,increment:{down:d(n,1),up:e(o,0),right:d(l,0),left:e(m,1)},closest:{down:b(h,k,0,"down"),up:b(h,k,0,"up"),right:b(h,i,1,"right"),left:b(h,i,1,"left")},furthest:{down:c(h,k,0,"down"),up:c(h,k,0,"up"),right:c(h,i,1,"right"),left:c(h,i,1,"left")}},a.each(j,function(a,b){x[g].down===!1&&(x[g].down=f(1,0,h,b)),x[g].up===!1&&(x[g].up=f(-1,0,h,b)),x[g].right===!1&&(x[g].right=f(0,1,h,b)),x[g].left===!1&&(x[g].left=f(0,-1,h,b))})})}function g(a){if("y"==p.options.direction){if("left"==a)return;"down"==a?p.next():"up"==a&&p.prev()}else if("x"==p.options.direction){if("up"==a)return;"left"==a?p.prev():"right"==a&&p.next()}else if(w){var b;if(x[s][a]!==!1)b=x[s][a];else if(p.options.jump===!0&&x[s].closest[a]!==!1)b=x[s].closest[a];else if(p.options.loop===!0)b=x[s].furthest[a];else if("loop-x"!=p.options.loop||"right"!=a&&"left"!=a||x[s].furthest[a]===!1)if("loop-y"!=p.options.loop||"down"!=a&&"up"!=a||x[s].furthest[a]===!1){if("string"==typeof p.options.loop){var c=("down"==a||"up"==a)&&"increment-y"==p.options.loop,d=("right"==a||"left"==a)&&"increment-x"==p.options.loop;if(x[s].increment[a]!==!1)(c||d||"increment"==p.options.loop)&&(b=x[s].increment[a]);else if("right"==a||"left"==a){if("increment-y"==p.options.loop)return;s==x.furthest_x?b=x.closest_x:s==x.closest_x&&(b=x.furthest_x)}else if("down"==a||"up"==a){if("increment-x"==p.options.loop)return;s==x.furthest_y?b=x.closest_y:s==x.closest_y&&(b=x.furthest_y)}}}else b=x[s].furthest[a];else b=x[s].furthest[a];"number"==typeof b&&i(b,p.options.time)}}function h(){if(b.location.hash){o=b.location.hash.split("/").pop();var c=!1;return a.each(p.options.ascensorFloorName,function(a){o===p.options.ascensorFloorName[a]&&(c=a)}),c}}function i(a,c,d){d=d||!1,j(s,a);var e={time:c||p.options.time,easing:p.options.easing,callback:function(){k(s,a)}};if("y"===p.options.direction)e.property={scrollTop:a*n};else if("x"===p.options.direction)e.property={scrollLeft:a*m};else if(w&&(e.property={scrollLeft:p.options.direction[a][1]*m,scrollTop:p.options.direction[a][0]*n},p.options.queued)){var f=q.scrollLeft()===p.options.direction[a][1]*m,g=q.scrollTop()===p.options.direction[a][0]*n;"x"===p.options.queued?f?e.property={scrollTop:p.options.direction[a][0]*n}:(e.property={scrollLeft:p.options.direction[a][1]*m},e.callback=function(){q.stop().animate({scrollTop:p.options.direction[a][0]*n},c,p.options.easing,function(){k(s,a)})}):"y"===p.options.queued&&(g?e.property={scrollLeft:p.options.direction[a][1]*m}:(e.property={scrollTop:p.options.direction[a][0]*n},e.callback=function(){q.stop().animate({scrollLeft:p.options.direction[a][1]*m},c,p.options.easing,function(){k(s,a)})}))}q.stop().animate(e.property,c,p.options.easing,e.callback),d&&"function"==typeof p.options.ready&&p.options.ready(),p.options.ascensorFloorName&&(b.location.hash="/"+p.options.ascensorFloorName[a]),s=a,q.data("current-floor",s)}function j(a,b){var c={from:a,to:b};q.trigger("scrollStart",c)}function k(a,b){var c={from:a,to:b};q.trigger("scrollEnd",c)}function l(b){var c=b.which;if(!a("input, textarea, button").is(":focus"))switch(c){case 40:case 83:if("x"==p.options.direction)return;q.trigger("scrollToDirection","down");break;case 38:case 87:if("x"==p.options.direction)return;q.trigger("scrollToDirection","up");break;case 37:case 65:if("y"==p.options.direction)return;q.trigger("scrollToDirection","left");break;case 39:case 68:if("y"==p.options.direction)return;q.trigger("scrollToDirection","right")}}var m,n,o,p=this,q=a(this.element),r=q.children(p.options.childType),s=p.options.windowsOn,t=-1,u=(p.options.direction,a(c)),v=a(b),w="object"==typeof p.options.direction,x=[];if(this.prev=function(){var a=s-1;if(0>a){if(!p.options.loop)return;a=t}i(a,p.options.time)},this.next=function(){var a=s+1;if(a>t){if(!p.options.loop)return;a=0}i(a,p.options.time)},q.on("scrollToDirection",function(a,b){g(b)}),q.on("scrollToStage",function(b,c){if("string"==typeof c){var d=a.inArray(c,p.options.ascensorFloorName);-1!==d&&i(d,p.options.time)}else if("number"==typeof c){if(c>t)return;i(c,p.options.time)}}),q.on("next",function(){p.next()}),q.on("prev",function(){p.prev()}),q.on("refresh",function(){(q.children().length>r.length||q.children().length<r.length)&&(r=q.children(p.options.childType),("x"===p.options.direction||w)&&r.css({position:"absolute",overflow:"auto"}),t=-1,r.each(function(){t+=1}),childrenLenght=q.children().length,q.trigger("refresh"),e(),f())}),q.css({position:"absolute",overflow:"hidden"}),r.each(function(){t+=1}),("x"===p.options.direction||w)&&r.css({position:"absolute",overflow:"auto"}),w&&f(),q.data("current-floor",s),p.options.keyNavigation&&u.keydown(l),p.options.ascensorFloorName&&b.location.hash){var y=h();y&&(s=y)}p.options.touchSwipeIntegration&&q.swipe({swipe:function(a,b){q.trigger("scrollToDirection",b)},threshold:70}),a(b).on("hashchange",function(){var a=h();a&&!q.is(":animated")&&i(a,p.options.time)}),v.resize(function(){e()}).load(function(){e()}).resize(),b.DeviceOrientationEvent&&v.bind("orientationchange",function(){e()}),i(s,1,!0)},a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))})}}(jQuery,window,document);