/*
Ascensor.js 
version: 1.6.2 (2013-10-12)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: LÃ©o Galley <contact@kirkas.ch>
*/
(function(o,n,t){function i(n,t){this.element=n,this.options=o.extend({},e,t),this._defaults=e,this._name=s,this.init()}var s="ascensor",e={ascensorName:"ascensor",ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",loop:!0,ascensorMap:"",time:"1000",easing:"linear",keyNavigation:!0,touchSwipeIntegration:!1,queued:!1,queuedDirection:"x"};i.prototype.init=function(){function i(){u=M.width(),f=M.height(),v.width(u).height(f),g.width(u).height(f),"y"===m.options.direction&&g.stop().scrollTop(m.floorActive*f),"x"===m.options.direction&&(g.stop().scrollLeft(m.floorActive*u),v.each(function(n){o(this).css("left",n*u)})),"chocolate"===m.options.direction&&(v.each(function(n){o(this).css({left:m.options.ascensorMap[n][1]*u,top:m.options.ascensorMap[n][0]*f})}),g.stop().scrollLeft(m.options.ascensorMap[w][1]*u).scrollTop(m.options.ascensorMap[w][0]*f))}function s(o){if("y"==m.options.direction){if("left"==o)return;"down"==o?a():"up"==o&&e()}else if("y"==m.options.direction){if("up"==o)return;"left"==o?e():"right"==o&&a()}else"chocolate"==m.options.direction&&("down"==o?c(1,0):"up"==o?c(-1,0):"left"==o?c(0,-1):"right"==o&&c(0,1))}function e(){var o=w-1;0>o&&(o=m.options.loop?y:0),r(o,m.options.time)}function a(){var o=w+1;o>y&&(o=m.options.loop?0:y),r(o,m.options.time)}function c(n,t){var i=[m.options.ascensorMap[w][0]+n,m.options.ascensorMap[w][1]+t];o.each(m.options.ascensorMap,function(o){""+i==""+m.options.ascensorMap[o]&&r(o,m.options.time)})}function p(t){n.location.hash&&(d=n.location.hash.split("/").pop(),o(m.options.ascensorFloorName).each(function(n){d===m.options.ascensorFloorName[n]&&(w=n,o("."+m.options.ascensorName+"Link").removeClass(m.options.ascensorName+"LinkActive").eq(w).addClass(m.options.ascensorName+"LinkActive"),t||r(w,m.options.time,!0))}))}function r(t,i,s){var e={time:i,easing:m.options.easing,callback:function(){l()}};if("y"===m.options.direction)e.property={scrollTop:t*f};else if("x"===m.options.direction)e.property={scrollLeft:t*u};else if("chocolate"===m.options.direction&&(e.property={scrollLeft:m.options.ascensorMap[t][1]*u,scrollTop:m.options.ascensorMap[t][0]*f},m.options.queued)){var a=g.scrollLeft()===m.options.ascensorMap[t][1]*u,c=g.scrollTop()===m.options.ascensorMap[t][0]*f;"x"===m.options.queuedDirection?a?e.property={scrollTop:m.options.ascensorMap[t][0]*f}:(e.property={scrollLeft:m.options.ascensorMap[t][1]*u},e.callback=function(){g.stop().animate({scrollTop:m.options.ascensorMap[t][0]*f},i,m.options.easing,function(){l()})}):"y"===m.options.queuedDirection&&(c?e.property={scrollLeft:m.options.ascensorMap[t][1]*u}:(e.property={scrollTop:m.options.ascensorMap[t][0]*f},e.callback=function(){g.stop().animate({scrollLeft:m.options.ascensorMap[t][1]*u},i,m.options.easing,function(){l()})}))}g.stop().animate(e.property,i,m.options.easing,e.callback),s||null===m.options.ascensorFloorName||(n.location.hash="/"+m.options.ascensorFloorName[t]),o("."+m.options.ascensorName+"Link").removeClass(m.options.ascensorName+"LinkActive"),o("."+m.options.ascensorName+"Link"+t).addClass(m.options.ascensorName+"LinkActive"),w=t}function l(){g.trigger({type:"ascensorEnd",floor:w})}function h(n){if(!o("input, textarea, button").is(":focus"))switch(n.which){case 40:case 83:s("down");break;case 38:case 87:s("up");break;case 37:case 65:s("left");break;case 39:case 68:s("right")}}var u,f,d,m=this,g=o(this.element),v=g.children(m.options.childType),w=m.options.windowsOn,y=-1,k=(m.options.direction,o(t)),M=o(n);g.on("scrollToStage",function(o,n){"next"==n?a():"prev"==n?e():s(n)}),g.on("update",function(){v=g.children(m.options.childType),i()});var N=m.options.ascensorName;o("."+N+"Link").on("click",function(){var n=parseInt(o(this).attr("class").split(" ")[1].split(m.options.ascensorName+"Link")[1],10);r(n,m.options.time)}),g.css({position:"absolute",width:u,height:f}),v.width(u).height(f).each(function(){y+=1,o(this).attr("id",m.options.ascensorName+"Floor"+y).addClass(m.options.ascensorName+"Floor")}),("x"===m.options.direction||"chocolate"===m.options.direction)&&v.css({position:"absolute",overflow:"auto"}),m.options.keyNavigation&&k.keydown(h),M.resize(function(){i()}).load(function(){i()}).resize(),n.DeviceOrientationEvent&&M.bind("orientationchange",function(){i()}),M.on("hashchange",function(){p()}),r(w,1,!0),p(!0),m.options.touchSwipeIntegration&&g.swipe({swipe:function(o,n){var t="";"up"==n?t="Down":"down"==n?t="Up":"left"==n?t="Right":"right"==n&&(t="Left"),g.trigger({type:"ascensor"+t,floor:w})},threshold:70})},o.fn[s]=function(n){return this.each(function(){o.data(this,"plugin_"+s)||o.data(this,"plugin_"+s,new i(this,n))})}})(jQuery,window,document);