/*
Ascensor.js 
version: 1.7.0 (2014-02-16)
description: Ascensor is a jquery plugin which aims to train and adapt content according to an elevator system
repository: https://github.com/kirkas/Ascensor.js
license: BSD
author: LÃ©o Galley <contact@kirkas.ch>
*/
(function(t,o,n){function i(o,n){this.element=o,this.options=t.extend({},r,n),this._defaults=r,this._name=e,this.init()}var e="ascensor",r={ascensorFloorName:null,childType:"div",windowsOn:0,direction:"y",loop:!1,width:"100%",height:"100%",context:t(o),time:300,easing:"linear",keyNavigation:!0,touchSwipeIntegration:!1,queued:!1,jump:!1,ready:!1};i.prototype.init=function(){function i(t,o){return"string"!=typeof t?t:-1!==t.indexOf("%")?o/100*parseInt(t,10):-1!==t.indexOf("px")?parseInt(t,10):undefined}function e(){a=i(g.options.width,g.options.context.width()),h=i(g.options.height,g.options.context.height()),v.width(a).height(h),y.width(a).height(h),"y"===g.options.direction&&y.stop().scrollTop(x*h),"x"===g.options.direction&&(y.stop().scrollLeft(x*a),v.each(function(o){t(this).css("left",o*a)})),O&&(v.each(function(o){t(this).css({left:g.options.direction[o][1]*a,top:g.options.direction[o][0]*h})}),y.stop().scrollLeft(g.options.direction[x][1]*a).scrollTop(g.options.direction[x][0]*h))}function r(){function o(o,n,i,e){var r=o[i],s=!1;return t.each(n,function(){(("right"==e||"down"==e)&&this[i]>o[i]||("left"==e||"up"==e)&&this[i]<o[i])&&(!s||Math.abs(this[i]-r)<Math.abs(s[i]-r))&&(s=this)}),s&&-1!==f.indexOf(s)?f.indexOf(s):!1}function n(o,n,i){var e=o[i],r=!1;return t.each(n,function(){(!r||Math.abs(this[i]-e)>Math.abs(r[i]-e))&&(r=this)}),r&&-1!==f.indexOf(r)?f.indexOf(r):!1}function i(o,n){var i=0,e=!1;return t.each(o,function(){(!e||Math.abs(this[n]-i)>Math.abs(e[n]-i))&&(e=this)}),e&&-1!==f.indexOf(e)?f.indexOf(e):!1}function e(o,n){var i=0,e=!1;return t.each(o,function(){(!e||Math.abs(this[n]-i)>Math.abs(e[n]-i))&&(e=this)}),e&&-1!==f.indexOf(e)?f.indexOf(e):!1}function r(t,o,n,i){return n[0]+t==i[0]&&n[1]+o==i[1]?f.indexOf(i):!1}function s(t,o){var n=!1;return jQuery.each(t,function(t,i){(n===!1||n[o]<i[o])&&(n=i)}),n}function c(t,o){var n=!1;return jQuery.each(t,function(t,i){(n===!1||n[o]>i[o])&&(n=i)}),n}function p(t,o){return jQuery.grep(f,function(n){var i=n[o]==t[o];return i})}var f=jQuery.grep(g.options.direction,function(t,o){return y.children().length>o}),u=s(f,1),l=p(u,1),a=s(l,0),h=s(f,0),d=p(h,0),v=s(d,1);T.furthest_x=f.indexOf(v),T.furthest_y=f.indexOf(a);var x=c(f,1),m=p(x,1),w=c(m,0),b=c(f,0),O=p(b,0),_=c(O,1);T.closest_x=f.indexOf(_),T.closest_y=f.indexOf(w),t.each(f,function(s,c){var p=jQuery.grep(f,function(t){var o=t[0]==c[0],n=c==t;return o&&!n}),u=jQuery.grep(f,function(t){var o=t[1]==c[1],n=c==t;return o&&!n}),l=jQuery.grep(f,function(t){var o=t[0]==c[0]+1;return o}),a=jQuery.grep(f,function(t){var o=t[0]==c[0]-1;return o}),h=jQuery.grep(f,function(t){var o=t[1]==c[1]+1;return o}),d=jQuery.grep(f,function(t){var o=t[1]==c[1]-1;return o});T[s]={down:!1,up:!1,right:!1,left:!1,increment:{down:i(h,1),up:e(d,0),right:i(l,0),left:e(a,1)},closest:{down:o(c,u,0,"down"),up:o(c,u,0,"up"),right:o(c,p,1,"right"),left:o(c,p,1,"left")},furthest:{down:n(c,u,0,"down"),up:n(c,u,0,"up"),right:n(c,p,1,"right"),left:n(c,p,1,"left")}},t.each(f,function(t,o){T[s].down===!1&&(T[s].down=r(1,0,c,o)),T[s].up===!1&&(T[s].up=r(-1,0,c,o)),T[s].right===!1&&(T[s].right=r(0,1,c,o)),T[s].left===!1&&(T[s].left=r(0,-1,c,o))})})}function s(t){if("y"==g.options.direction){if("left"==t)return;"down"==t?g.next():"up"==t&&g.prev()}else if("x"==g.options.direction){if("up"==t)return;"left"==t?g.prev():"right"==t&&g.next()}else if(O){var o;if(T[x][t]!==!1)o=T[x][t];else if(g.options.jump===!0&&T[x].closest[t]!==!1)o=T[x].closest[t];else if(g.options.loop===!0)o=T[x].furthest[t];else if("loop-x"!=g.options.loop||"right"!=t&&"left"!=t||T[x].furthest[t]===!1)if("loop-y"!=g.options.loop||"down"!=t&&"up"!=t||T[x].furthest[t]===!1){if("string"==typeof g.options.loop){var n=("down"==t||"up"==t)&&"increment-y"==g.options.loop,i=("right"==t||"left"==t)&&"increment-x"==g.options.loop;if(T[x].increment[t]!==!1)(n||i||"increment"==g.options.loop)&&(o=T[x].increment[t]);else if("right"==t||"left"==t){if("increment-y"==g.options.loop)return;x==T.furthest_x?o=T.closest_x:x==T.closest_x&&(o=T.furthest_x)}else if("down"==t||"up"==t){if("increment-x"==g.options.loop)return;x==T.furthest_y?o=T.closest_y:x==T.closest_y&&(o=T.furthest_y)}}}else o=T[x].furthest[t];else o=T[x].furthest[t];"number"==typeof o&&p(o,g.options.time)}}function c(){if(o.location.hash){d=o.location.hash.split("/").pop();var n=!1;return t.each(g.options.ascensorFloorName,function(t){d===g.options.ascensorFloorName[t]&&(n=t)}),n}}function p(t,n,i){i=i||!1,f(x,t);var e={time:n||g.options.time,easing:g.options.easing,callback:function(){u(x,t)}};if("y"===g.options.direction)e.property={scrollTop:t*h};else if("x"===g.options.direction)e.property={scrollLeft:t*a};else if(O&&(e.property={scrollLeft:g.options.direction[t][1]*a,scrollTop:g.options.direction[t][0]*h},g.options.queued)){var r=y.scrollLeft()===g.options.direction[t][1]*a,s=y.scrollTop()===g.options.direction[t][0]*h;"x"===g.options.queued?r?e.property={scrollTop:g.options.direction[t][0]*h}:(e.property={scrollLeft:g.options.direction[t][1]*a},e.callback=function(){y.stop().animate({scrollTop:g.options.direction[t][0]*h},n,g.options.easing,function(){u(x,t)})}):"y"===g.options.queued&&(s?e.property={scrollLeft:g.options.direction[t][1]*a}:(e.property={scrollTop:g.options.direction[t][0]*h},e.callback=function(){y.stop().animate({scrollLeft:g.options.direction[t][1]*a},n,g.options.easing,function(){u(x,t)})}))}y.stop().animate(e.property,n,g.options.easing,e.callback),i&&"function"==typeof g.options.ready&&g.options.ready(),g.options.ascensorFloorName&&(o.location.hash="/"+g.options.ascensorFloorName[t]),x=t,y.data("current-floor",x)}function f(t,o){var n={from:t,to:o};y.trigger("scrollStart",n)}function u(t,o){var n={from:t,to:o};y.trigger("scrollEnd",n)}function l(o){var n=o.which;if(!t("input, textarea, button").is(":focus"))switch(n){case 40:case 83:if("x"==g.options.direction)return;y.trigger("scrollToDirection","down");break;case 38:case 87:if("x"==g.options.direction)return;y.trigger("scrollToDirection","up");break;case 37:case 65:if("y"==g.options.direction)return;y.trigger("scrollToDirection","left");break;case 39:case 68:if("y"==g.options.direction)return;y.trigger("scrollToDirection","right")}}var a,h,d,g=this,y=t(this.element),v=y.children(g.options.childType),x=g.options.windowsOn,m=-1,w=(g.options.direction,t(n)),b=t(o),O="object"==typeof g.options.direction,T=[];if(this.prev=function(){var t=x-1;if(0>t){if(!g.options.loop)return;t=m}p(t,g.options.time)},this.next=function(){var t=x+1;if(t>m){if(!g.options.loop)return;t=0}p(t,g.options.time)},y.on("scrollToDirection",function(t,o){s(o)}),y.on("scrollToStage",function(o,n){if("string"==typeof n){var i=t.inArray(n,g.options.ascensorFloorName);-1!==i&&p(i,g.options.time)}else if("number"==typeof n){if(n>m)return;p(n,g.options.time)}}),y.on("next",function(){g.next()}),y.on("prev",function(){g.prev()}),y.on("refresh",function(){(y.children().length>v.length||y.children().length<v.length)&&(v=y.children(g.options.childType),("x"===g.options.direction||O)&&v.css({position:"absolute",overflow:"auto"}),m=-1,v.each(function(){m+=1}),childrenLenght=y.children().length,y.trigger("refresh"),e(),r())}),y.css({position:"absolute",overflow:"hidden"}),v.each(function(){m+=1}),("x"===g.options.direction||O)&&v.css({position:"absolute",overflow:"auto"}),O&&r(),y.data("current-floor",x),g.options.keyNavigation&&w.keydown(l),g.options.ascensorFloorName&&o.location.hash){var _=c();_&&(x=_)}g.options.touchSwipeIntegration&&y.swipe({swipe:function(t,o){y.trigger("scrollToDirection",o)},threshold:70}),t(o).on("hashchange",function(){var t=c();t&&!y.is(":animated")&&p(t,g.options.time)}),b.resize(function(){e()}).load(function(){e()}).resize(),o.DeviceOrientationEvent&&b.bind("orientationchange",function(){e()}),p(x,1,!0)},t.fn[e]=function(o){return this.each(function(){t.data(this,"plugin_"+e)||t.data(this,"plugin_"+e,new i(this,o))})}})(jQuery,window,document);